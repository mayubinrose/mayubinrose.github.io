---
layout: title
title: 代码优化
date: 2018-12-12 19:35:19
tags: 编译原理
categories: 课程
---
# 优化的种类
机器相关性：寄存器，多处理器，特殊指令优化，无用指令消除
优化范围：局部优化：单个剧本快范围内的优化，常量合并优化，公共子表达式删除。计算强度消弱和无用代码删除。全局优化：基于循环的优化：循环不变优化，归纳变量删除，计算强度消弱
优化语言级：针对中间代码，针对机器语言
 <!--more--> 
## 公共子表达式消除
## 复制传播
复制传播变换的思想是在复制语句f := g之后尽可能用g代替f，复制传播变换本身并不是优化，但它给其它优化带来机会
## 无用代码删除
无用代码是指的是计算结果以后不被引用的语句
## 代码外提
将循环不变计算从循环中移除到循环的前面
## 强度消弱
实现同样的运算可以有多种方式，用计算较快的运算代替慢的
# 控制流分析
对循环优化->分析控制流程。首先要将程序划分为基本块集合并转换成流图，然后从流图中找出循环
## 基本块
基本块(basic block)是一个连续的语句序列，控制流从它的开始进入，并从它的末尾离开，中间不存在中断或分支(末尾除外)
## 流图
程序的控制流信息可以用流图表示，节点为基本块的有向图。以程序的第一个语句作为入口语句的节点称为初始节点如果在某个执行序列中B2跟随在Bl之后，则从Bl到B2有一条有向边。如果从Bl的最后一条语句有条件或无条件转移到B2的第一个语句；或者按程序正文的次序B2紧跟在Bl之后，并且Bl不是结束于无条件转移，则称B1是B2的前驱，而B2是Bl的后继
# 局部优化
基本块的功能实际上就是计算一组表达式，，这些表达式是在基本块出口活跃的变量的值。如果两个基本块计算一组同样的表达式，则称它们是等价的。 可以对基本块应用很多变换而不改变它所计算的表达式集合，许多这样的变换对改进最终由某基本块生成的代码的质量很有用。
利用基本块的dag表示可以实现一些常用的对基本块的变换
⑴ 局部公共子表达式删除。
⑵ 无用代码删除。
⑶ 交换两个独立的相邻语句的次序，以便减少某个临时值需要保存在寄存器中的时间。
⑷ 使用代数规则重新排列三地址码的运算对象的顺序，以便简化计算过程。
# 循环优化
循环不变计算的检测
代码外提
归纳变量删除和强度削弱
# 全局优化
全局公共子表达式的删除
复制传播

