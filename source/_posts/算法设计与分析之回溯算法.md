---
title: 算法设计与分析之回溯与分支界限算法
date: 2020-03-15 09:09:26
tags: 算法设计与分析
categories: 课程
---
## 回溯算法基本思想
```bash
1.适用：求解搜索问题和优化问题
2.搜索空间：树，结点对应部分解向量，可行解在树叶上
3.搜索过程：采用系统的方法隐含的遍历搜索树
4.搜索策略：深度优先，宽度优先，函数优先，宽深结合
5.结点分支判定条件：满足约束条件，分支扩张解向量，不满足约束条件，回溯到该结点的父节点
6.结点状态：动态生成，分为白色黑色灰色结点
7.存储：当前路径
```
 <!--more--> 
**适用条件：多米诺性质：符合k+1的解同样符合k的解的性质，以及逆否命题的成立**
![sd](/算法设计与分析之回溯算法/3.png)
![sd](/算法设计与分析之回溯算法/4.png)
## 回溯算法的实现
递归实现与迭代实现
## 例子：4后问题
问题：在4*4的方格棋盘上放置皇后，使得没有两个在同一行，同一列，对角线
## 例子:0-1背包问题
问题：有n种物品，每种只有一个，第i种物品价值为vi，重量为wi，如何选择使得总重量不超过B，而价值达到最大
**回溯算法或者贪心算法都可以，并且类似于最小装载问题**
![sd](/算法设计与分析之回溯算法/1.png)
## 例子:货郎问题
问题：有n个城市，已知任两个城市之间的距离，求一条每个城市都经过一次的回路，使得总长度最小
![sd](/算法设计与分析之回溯算法/2.png)
搜索空间：排列树，有（n-1）!片树叶

## 例子：装载问题
问题：与之前的装载问题不同，这里有两艘轮船，载重分别为c1和c2，所有的集装箱的重量和小于c1+c2，求合理的方案，所有的箱子都上船
算法思想：令第一艘船的装入量为w1
1.用回溯算法使得c1-w1达到最小的装载方案
2.然后判断剩下的总重量是否满足第二艘船
![sd](/算法设计与分析之回溯算法/5.png)
每一层的选择都有两个，所以时间复杂度为O(2^n)
## 例子：图的着色
问题：无向连通图G与m种颜色的集合，用这些颜色给图的顶点着色，每个顶点一种颜色，要求每条边的两个顶点的颜色不同
约束条件：顶点k+1的邻接表中结点用过的颜色不能再用，如果邻接表结点用过m种，则结点k+1没法着色，从该节点回溯到父节点，满足多米诺性质
搜索策略：深度优先
时间复杂度：O(nm^n)
![sd](/算法设计与分析之回溯算法/6.png)
**时间复杂度与改进途径:根据对称性，只需要搜索1/3的解空间**
## 搜索树结点的估计
**Monte Carlo方法**
```bash
1.从根开始，随机选择一条路径，直到不能分支为止
2.假定搜索树的其他的分支与以上随机选出的路径一样，计数搜索树的点数
3.重复1，2，将结点数进行概率平均
```
例如对于四后问题的搜索树采用Monte Carlo方法进行估计
![sd](/算法设计与分析之回溯算法/7.png)
剩下的没有给出图示，进行多次抽样，每次给出的计算平均节点数
## 分支界限及其应用
## 最大团问题
最大团：顶点数最多的团，团中包含的顶点是一个完全图
问题：给定无向图，求最大团
蛮力算法：对每个顶点子集，检查是否构成团，检查每对顶点之间是否有边，有2^n个子集
分支界限：
